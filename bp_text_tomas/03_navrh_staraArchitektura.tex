% sem jsem zkopíroval původní část o architektuře


\section{Architektura aplikace}

\subsection{Komunikace s uživatelem}

Moje aplikace je klasickým síťovým serverem, který poslouchá na několika portech, přijímá spojení a zpracovává je. V mém případě bude aplikace poslouchat na tolika portech, kolik má virtuální síť počítačů, pro každý počítač je vyrazen právě jeden port. Aby aplikace mohla poslouchat na více portech najednou, je nutné vytvořit více vláken aby na každém portu poslouchalo jedno vlákno. Jak plyne z posledního funkčního požadavku, musí jeden virtuální počítač umět zpracovat i více spojení najednou, jako i na reálný linuxový počítač je možné se připojit k několika jeho terminálům pomocí protokolu ssh nebo telnet. Proto je nutné, aby vlákno, které poslouchá na portu, pro příchozí spojení vytvořilo jiné vlákno, které spojení obslouží, a samo dále poslouchalo na určeném portu. 

\subsection{Virtuální počítačová síť}

% obecnej popis, posílání paketů
Virtuální počítačová síť se skládá z objektů representujících jednotlivé síťové prvky. Poskytuje především tyto funkcionality:
\begin{itemize}
 \item Možnost konfigurace jednotlivých síťových prvků.
 \item Posílání paketů mezi síťovými prvky.
\end{itemize}
Konfigurace síťových prvků se odehrává telnetovým připojením. Každý ze síťových prvků si tedy drží vlastní objekt, který bude tuto komunikaci obsluhovat. Posílání, přeposílání a přijímání paketů musí síťové prvky vyřizovat samy, a to stejně jako síťové prvky skutečné sítě, aby při stejné konfiguraci skutečné a virtuální počítačové sítě tato síť i stejně fungovala. To jest, aby ve virtuální počítačové síti došly právě ty pakety, které při stejné konfiguraci dojdou na síti skutečné. Protože virtuální síť je reprezentována objekty v paměti, neposílají si virtuální síťové prvky skutečné pakety, ale pomocí metod si předávají objekty typu paket, které nesou všechny potřebné informace jako reálný paket.\\
% neuvažuju switche:
V laboratořích předmětu Y36PSI studenti nastavují pouze PC nebo směrovače na 3. (síťové) vrstvě ISO/OSI modelu\footnote{3. vrstva ISO modelu, tzv. síťová vrstva, zajišťuje spojení mezi jakýmikoliv 2 uzly sítě.}. Síťové prvky pracující na 2. vrstvě ISO/OSI modelu\footnote{2. vrstva ISO/OSI modelu, tzv. spojová nebo linková vrstva, zajišťuje spojení mezi dvěma sousedními systémy.}, switche a bridge se v laboratořích vůbec neuvažují. Nebudu je proto uvažovat ani ve své aplikaci.
\subsubsection{Síťové prvky}
%popis linuxovýho počítače:
Jedinými síťovými prvky mojí aplikace jsou počítače s operačním systémem Linux, které fungují jako směrovače na síťové vrstvě ISO/OSI modelu. Síťovou komunikaci skutečného počítače zajišťuje modul v jádře operačního systému. Počítač má několik síťových rozhraní. Síťové rozhraní se skládá z fysické části, kterou je síťový adaptér, a z části softarové, kterou je jeho konfigurace. Ke každému síťovému adaptéru, tzn. ke každému rozhraní, může být připojen maximálně jeden síťový kabel, který, protože neuvažuji switche, je zapojen do jiného rozhraní nějakého počítače, nebo není zapojen nikam. Virtuální počítač i síťové rozhraní budou v mé aplikaci representovány objekty, mají svou vlastní třídu.\\ 
% routovací a natovací tabulka - popis
Jádro operačního systému směruje pakety podle tzv. routovací tabulky, což je datová struktura, která obsahuje cílové adresy a akce, které se mají vykonat s paketem poslaným na danou cílovou adresu. Jedním z požadavků je překlad adres. Ten provádí také jádro operačního systému podle nastavení paketového filtru. Ke správnému fungování tohoto překladu potřebuje jádro další datovou strukturu, natovací tabulku, kam si ukládá, jak má adresy překládat. Oběma těmto tabulkám vytvořím třídu,
\subsubsection{Infrastruktura sítě}
Jak bylo napsáno v předešlém odstavci, jediným síťovým prvkem mojí aplikace je počítač s OS Linux. Každé jeho síťové rozhraní může být kabelem propojeno s jiným síťovým rozhraním. Infrastruktura sítě je proto jednoznačně určena dvojicemi síťových rozhraní, která jsou propojena síťovým kabelem. Tuto infrastrukturu sítě je v konfiguračním souboru dobré oddělit od ostatní konfigurace, aby ji mohl uživatel lehce přečíst a pochopit, popř. změnit. Síťové rozhraní je jednoznačně identifikováno jménem počítače a jménem rozhaní.
% \subsubsection{Representace sítě v aplikaci}
% Jednotlivé síťové entity, jako třeba počítač nebo jeho síťové rozhraní, budou v aplikaci representovány objekty. Pro každý druh entity tedy vytvořím třídu. Každý počítač bude jednoznačně identifikován svým jménem, každé síťové rozhraní bude identifikováno jménem počítače a jménem rozhraní. Jak jsem již psal výše, k posílání paketů potřebuje počítač další datové struktury, natovací a routovací, neboli směrovací, tabulku. Virtuální počítač bude konfigurován telnetem, proto si, kromě svých metod pro posílání paketů, drží i objekt, který za něj tuto komunikaci vyřizuje.


\subsection {Datové struktury}



% \subsection{Vlákna}
% 
% Poslední funkční požadavek říká, že má být možné, připojit se telnetem k více virtuálním počítačům i vícekrát k jednomu virtuálnímu počítači, tak, jak by to bylo možné i na reálné síti. Tento požadavek lze jednoduše vyřešit tak, že naše aplikace poběží ve vláknech, které Java podporuje. 



